#include	"globals extern.h"#ifdef useProfiler#pragma profile on#endifvoid SmallBlit(short *source, long sourceOffSet, short *dest){	long i = 24;	long j, temp;	register long destOffSet = theGWorlds.safeRowOffSet;	sourceOffSet >>= 1;	destOffSet >>= 1;	do	{		for (j = 0; j < 24; j++)		{			temp = source[j];			if (temp != 32767) dest[j] = source[j];		}		dest += destOffSet;		source += sourceOffSet;	} while (--i);}#ifdef DEMOvoid WorldCheckSeven(void){	long	size, j;	long	count = 0;	size = GetResourceSizeOnDisk((Handle)theWorldOther)/2;		for (j = 0; j < size; j++)	{		count += (*theWorldOther)[j] * (j & 14);	}		if ((count != 1647572) && (count != 668228) && (count != 1323660)) hackedSeven = true;}#endifvoid SpringBlit(short *source, long sourceOffSet, short *dest, short height){	short t;	long	j;	register long destOffSet = theGWorlds.safeRowOffSet;	long	i = height;	sourceOffSet >>= 1;	destOffSet >>= 1;		do	{		for (j = 0; j < 24; j++)		{			t = source[j];			if (t != 32767) dest[j] = t;		}		dest += destOffSet;		source += sourceOffSet;	} while (--i);}void ItemBlit(short *source, long sourceOffset, short *dest, long height, long width){	short t;	long	j;	register long destOffset = theGWorlds.safeRowOffSet;	long	i = height;	sourceOffset >>= 1;	destOffset >>= 1;		do	{		for (j = 0; j < width; j++)		{			t = source[j];			if (t != 32767) dest[j] = t;		}		dest += destOffset;		source += sourceOffset;	} while (--i);}void BlitDarwin(short	horiz, short vert){	register	short sourceOffset, destOffset;	short	*source, *dest;	long	i, j;	short	t, destColor;		sourceOffset = theGWorlds.darwinRowOffSet/2;	destOffset = theGWorlds.safeRowOffSet/2;		source = (short *)(theGWorlds.darwinMemPtr + (player.iconRow * theGWorlds.darwinRowOffSet) + (2 * player.frame * darwinWidth));	dest = (short *)(theGWorlds.safeMemPtr + (vert * theGWorlds.safeRowOffSet) + (2 * horiz));	i = darwinHeight;		if (player.directionFacing == directionLeft)	// flip horizontal if facing left	{		do		{			for (j = 0; j < darwinWidth; j++)			{				t = source[darwinWidth - (j+1)];				if (t != 32767) dest[j] = t;			}			dest += destOffset;			source += sourceOffset;		} while (--i);	}	else	{		do		{			for (j = 0; j < darwinWidth; j++)			{				t = source[j];				if (t != 32767) dest[j] = t;			}			dest += destOffset;			source += sourceOffset;		} while (--i);	}		if (player.powerUp & (doublePoints + quadPoints))	{		source = (short *)(theGWorlds.darwinMemPtr + (72 * theGWorlds.darwinRowOffSet) + 2344);		dest = (short *)(theGWorlds.safeMemPtr + (vert * theGWorlds.safeRowOffSet) + (2 * (horiz - 4)));				if (frameCount & 2) dest += theGWorlds.safeRowOffSet;		else if (frameCount & 4) dest += theGWorlds.safeRowOffSet * 2;			if (player.powerUp & quadPoints) source += 16;			i = 16;				do		{			for (j = 0; j < 16; j++)			{				t = source[j];				destColor = dest[j];								if (t != 32767)				{					UInt16 red, green, blue;										blue = ((destColor & 0x001F) + (t & 0x001F))/2;					green = ((destColor & 0x03E0) + (t & 0x03E0))/2;					red = ((destColor & 0x7C00) + (t & 0x7C00))/2;										blue = blue & 0x001F;					green = green & 0x03E0;					red = red & 0x7C00;										dest[j] = (red | green | blue);				}			}			dest += destOffset;			source += sourceOffset;		} while (--i);	}		if (player.powerUp & (beanieHat + shield))	{		source = (short *)(theGWorlds.darwinMemPtr + (72 * theGWorlds.darwinRowOffSet) + 2408);		dest = (short *)(theGWorlds.safeMemPtr + (vert * theGWorlds.safeRowOffSet) + (2 * (horiz + 52)));		if (frameCount & 2) dest += theGWorlds.safeRowOffSet;		else if (frameCount & 4) dest += theGWorlds.safeRowOffSet * 2;		if (player.powerUp & shield) source += 16;				if (((player.powerUp & shield) == 0) && (player.iconRow == jumpRow) && (player.frame > 13))		{			// only got beanie hat, and using the correct frames, so no need for icon				}		else		{			i = 16;					do			{				for (j = 0; j < 16; j++)				{					t = source[j];					destColor = dest[j];										if (t != 32767)					{						UInt16 red, green, blue;												blue = ((destColor & 0x001F) + (t & 0x001F))/2;						green = ((destColor & 0x03E0) + (t & 0x03E0))/2;						red = ((destColor & 0x7C00) + (t & 0x7C00))/2;												blue = blue & 0x001F;						green = green & 0x03E0;						red = red & 0x7C00;												dest[j] = (red | green | blue);					}				}				dest += destOffset;				source += sourceOffset;			} while (--i);		}	}}void MonsterBlit(short *source, long sourceOffset, short *dest,						long height, long width, Boolean invert, short inset){	short t;	long	j;	long	i = height;	register long destOffset = theGWorlds.safeRowOffSet;	sourceOffset >>= 1;	destOffset >>= 1;	if (invert)	// flip horizontal	{		do		{			for (j = 0; j < width; j++)			{				t = source[inset + width - (j+1)];				if (t != 32767) dest[j] = t;			}			dest += destOffset;			source += sourceOffset;		} while (--i);	}	else	{		do		{			for (j = 0; j < width; j++)			{				t = source[inset + j];				if (t != 32767) dest[j] = t;			}			dest += destOffset;			source += sourceOffset;		} while (--i);	}}void DoorBlit(short *source, long sourceOffset, short *dest,						long height, long width){	short t;	long	j;	long	i = height;	register long destOffset = theGWorlds.safeRowOffSet;	sourceOffset >>= 1;	destOffset >>= 1;	do	{		for (j = 0; j < width; j++)		{			t = source[j];			if (t != 32767) dest[j] = t;		}			dest += destOffset;		source += sourceOffset;	} while (--i);}#ifdef useProfiler#pragma profile off#endif